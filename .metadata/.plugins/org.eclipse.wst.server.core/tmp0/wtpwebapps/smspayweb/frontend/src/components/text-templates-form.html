<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/vaadin-form-layout/src/vaadin-form-layout.html">
<link rel="import" href="../../bower_components/vaadin-form-layout/src/vaadin-form-item.html">
<link rel="import" href="../../bower_components/vaadin-text-field/src/vaadin-text-field.html">
<link rel="import" href="form-buttons-bar.html">
<link rel="import" href="../../bower_components/vaadin-text-field/src/vaadin-text-area.html">
<script src="../js/gsm7.js"></script>


<dom-module id="text-templates-form">
    <template>
<style>

:host {
		width: 100%;
		height: 100%;
		display: flex;
		flex-direction: column;
	}
 	#form {
		 display: flex;
		 flex-direction: column;
		 flex: 1;
	}
	vaadin-form-item {
		width: 100% !important;
		margin: var(--lumo-space-m) 0px 0px 0px;
	}
	vaadin-form-item .input {
		width: 100%;
	}
	vaadin-text-area.max-height {
		min-height: 200px;
    	max-height: 250px;
  	}

</style>
<h3 id="caption">Text</h3>
<vaadin-form-layout id="form">
 <vaadin-form-item label-position="top" id="title-item">
  <label slot="label">Title</label>
  <vaadin-text-field id="title" class="input"></vaadin-text-field>
 </vaadin-form-item>
 <vaadin-form-item label-position="top" id="text-item">
  <label slot="label">Message text</label>
  <vaadin-text-area id="text" class="input max-height" theme="scroll" value="{{textValue}}" on-input="updateSmsCounter">
  </vaadin-text-area>
 </vaadin-form-item>
</vaadin-form-layout>
<form-buttons-bar id="buttons"></form-buttons-bar>
</template>
    <script>
        class TextTemplatesForm extends Polymer.Element {
            static get is() {
                return 'text-templates-form';
            }
            static get properties() {
                return {
                    // Declare your properties here.
                };
            }
            
            updateSmsCounter(){
            	var vaadinServer = this.$server;
            	var sms = UcmsGsm7Class();
            	
            	var info = sms.gsm_text_info(this.textValue);
            	
				vaadinServer.setSmsCounterValues(info.gsm7_convertible, 
					info.concatenated_sms, info.codepoints_used, info.codepoints_used_total, 
						info.codepoints_per_sms_useable, info.codepoints_per_sms, codepoints_left)
            }	
        }
        
        customElements.define(TextTemplatesForm.is, TextTemplatesForm);
    </script>
</dom-module>